<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.update.semi.sdboard">

<resultMap type="sdboardDto" id="sduserMap">
	<result property="sdbseq" column="SDBSEQ"/>
	<result property="sdbtabno" column="SDBTABNO"/>
	<result property="sdbgroupseq" column="SDBGROUPSEQ"/>
	<result property="sdbgroupno" column="SDBGROUPNO"/>
	<result property="sdbtitle" column="SDBTITLE"/>
	<result property="sduemail" column="SDUEMAIL"/>
	<result property="sdubcontent" column="SDUBCONTENT"/>
	<result property="sdbregdate" column="SDBREGDATE"/>
	<result property="sdbviews" column="SDBVIEWS"/>
	<result property="sdblike" column="SDBLIKE"/>
	<result property="sdbfilpath" column="SDBFILPATH"/>
	<result property="sdbimgpath" column="SDBIMGPATH"/>
	<result property="sdunick" column="SDUNICK"/>
	<result property="thumbnail" column="THUMBNAIL"/>
	
</resultMap>

<select id="selectList" resultMap="sduserMap">
select *  from SDBOARD ORDER BY SDBSEQ DESC
</select>

<select id="selectOne" resultMap="sduserMap">
select * from SDBOARD where SDBSEQ = #{sdbseq}
</select>

<select id="getBoardNo" resultType="int">
select SDBSEQ from SDBOARD where SDUEMAIL=#{sduemail} and THUMBNAIL=#{thumbnail}
</select>

<insert id="insertwrite" parameterType="sdboardDto">
insert into SDBOARD(SDBSEQ,SDBTITLE,SDUEMAIL,SDUNICK,SDUBCONTENT,SDBREGDATE,SDBFILPATH,SDBIMGPATH,THUMBNAIL) 
values(SDBSEQ.NEXTVAL,#{sdbtitle},#{sduemail},#{sdunick},#{sdubcontent},SYSDATE,#{sdbfilpath},#{sdbimgpath},#{thumbnail})
</insert>

<insert id="insertImg" parameterType="sdboardDto">
insert into SDBOARD(SDBSEQ,SDUEMAIL,SDUNICK,SDBIMGPATH,THUMBNAIL) 
values(SDBSEQ.NEXTVAL,#{sduemail},#{sdunick},#{sdbimgpath},#{thumbnail})
</insert>

<insert id="insertNoImgBoard" parameterType="sdboardDto">
insert into SDBOARD(SDBSEQ,SDBTITLE,SDUEMAIL,SDUNICK,SDUBCONTENT,SDBREGDATE,SDBFILPATH,SDBIMGPATH,THUMBNAIL,SDBTABNO,SDBGROUPSEQ,SDBGROUPNO,SDBVIEWS,SDBLIKE) 
values(SDBSEQ.NEXTVAL,#{sdbtitle},#{sduemail},#{sdunick},#{sdubcontent},SYSDATE,#{sdbfilpath},null,null,0,0,0,0,0)
</insert>

<update id="updateRestContent" parameterType="sdboardDto">
update SDBOARD set SDBTITLE=#{sdbtitle},SDUBCONTENT=#{sdubcontent},SDBFILPATH=#{sdbfilpath} 
where SDBSEQ =#{sdbseq}
</update>

<update id="updatewrite">
update SDBOARD set SDBTITLE=#{sdbtitle},SDUBCONTENT=#{sdubcontent},SDBFILPATH=#{sdbfilpath},SDBIMGPATH=#{sdbimgpath}
where SDBSEQ =#{sdbseq}
</update>


<delete id="deletewrite" parameterType="int">
delete from SDBOARD where SDBSEQ =#{sdbseq}
</delete>

<select id="rnlist" parameterType="sdboardDto">
SELECT X.RN, X.SDBSEQ, X.SDUNICK, X.SDBTITLE, X.SDBREGDATE
FROM (
	SELECT ROWNUM AS RN, A.SDBSEQ, A.SDUNICK, A.SDBTITLE, A.SDBREGDATE
	FROM (
		SELECT SDBSEQ, SDUNICK, SDBTITLE, SDBREGDATE
		FROM SDBOARD
		ORDER BY SDBSEQ DESC) A
	WHERE ROWNUM <![CDATA[<=]]> #{endCount }	
	)X	
WHERE X.RN >= #{startCount }
</select>

<select id="getTotalBoard" resultType="int">
SELECT COUNT(*)
FROM SDBOARD
<trim prefix="WHERE" prefixOverrides="AND">
<if test="category == 'title' and keyword != null and kyword != ''">
AND SDBTITLE LIKE ('%' || #{keyword} || '%')
</if>
<if test="category == 'content' and keyword != null and keyword != ''">
AND SDUBCONTENT LIKE ('%'|| #{keyword} ||'%')
</if>
<if test="category == 'nick' and keyword != null and keyword != ''">
AND SDUNICK LIKE ('%'|| #{keyword} ||'%')
</if>
</trim>
</select>

</mapper>
